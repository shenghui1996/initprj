$(function(){$.material.init()});jQuery.gblog=function(b){if(window.console){console.log(b)}else{}};jQuery.gberror=function(b){if(window.console){console.error(b)}else{}};function handleThisCallsErrors(c,b){alert("网站无法完成请求，请刷新重试");$.gberror("内部错误："+c)}dwr.engine.setErrorHandler(handleThisCallsErrors);String.prototype.trunc=function(b){return this.substr(0,b-1)+(this.length>b?"...":"")};function displaydate(b){var c=moment(),d=moment(b);if(c.diff(d,"days")>=1){return d.format("YYYY年MM月D日 HH:mm:ss")}else{return d.fromNow()}}function replacelinks(c){var e=/(\b(https?|ftp):\/\/[-A-Z0-9+\u0026@#\/%?=~_|!:,.;]*[-A-Z0-9+\u0026@#\/%=~_|])/gi,b="\u003c",d="\u003e";return c.replace(e,b+'a target="_blank" class="biggest" href=\'$1\''+d+"$1"+b+"/a"+d)}(function(b){var c=b({});b.each({trigger:"publish",on:"subscribe",off:"unsubscribe"},function(d,e){jQuery[e]=function(){c[d].apply(c,arguments)}})})(jQuery);$(function(){Handlebars.registerHelper("roleClass",function(b){if(b!==0){return"mdi-daren"}else{return""}});Handlebars.registerHelper("demoLinks",function(c){var e=c.demourl.split("#"),d=$("<div></div>");for(var b=0;b<e.length;b++){if(e[b]!==null&&e[b]!==""){if(e[b]!==null&&e[b].lastIndexOf("zip")<0){var f=e[b].substring(e[b].lastIndexOf("uploads/")+8);filename=f.substring(f.indexOf("/")+1);filename=filename.replace(/\//g,"|");zipfile=f.substring(0,f.indexOf("/"));if(zipfile===""){d.append('<li><a class="iconbefore gbdemobutton ui-state-hover" target="_blank" href="'+global_contextPath+"/demoviewer/"+c.pid+"/empty/"+filename+'.htm">在线演示'+b+"</a><li>&nbsp;")}else{d.append('<li><a class="iconbefore gbdemobutton ui-state-hover" target="_blank" href="'+global_contextPath+"/demoviewer/"+c.pid+"/"+zipfile+"/"+filename+'.htm">在线演示'+b+"</a><li>&nbsp;")}}else{d.append('<li><a class="iconbefore gbdownloadbutton ui-state-hover" target="_blank" href="'+global_contextPath+"/ajaxdownload.htm?filename="+e[b].substring(e[b].lastIndexOf("/")+1)+'"><span class="ui-icon ui-icon-circle-arrow-s"></span>本地下载</a><li>&nbsp;')}}}return d.html()});Handlebars.registerHelper("functionTagName",function(d){var i=d.usertagids.split(","),e=d.tags.split(","),h=d.usertagdaren.split(","),j=d.usertagfunctionflag.split(","),f="",b=d.avatar!==""?d.avatar:"avatar.jpg",c=0;if(d.uid===global_onlineuser.uid){c=1}for(var g=0;g<e.length;g++){if(j[g]==="1"){if(e[g]==="#原创"){f+='<a class="btn btn-xs btn-material-grey" role="button" href="'+global_contextPath+"/mobileusertag/"+i[g]+'.htm"><img class="hidden tagavatar '+(h[g]==="1"?"daren":"")+'" src="'+global_contextPath+"/networks/avatars/30x30"+b+'" /><span class="glyphicon glyphicon-thumbs-up"></span>'+e[g]+"</a>"}else{if(e[g]==="#文章"){f+='<a class="btn btn-xs btn-material-grey" role="button" href="'+global_contextPath+"/mobileusertag/"+i[g]+'.htm"><img class="hidden tagavatar '+(h[g]==="1"?"daren":"")+'" src="'+global_contextPath+"/networks/avatars/30x30"+b+'" /><span class="glyphicon glyphicon-link"></span>'+e[g]+"</a>"}else{if(e[g]==="#问答"){f+='<a class="btn btn-xs btn-material-grey" role="button" href="'+global_contextPath+"/mobileusertag/"+i[g]+'.htm"><img class="hidden tagavatar '+(h[g]==="1"?"daren":"")+'" src="'+global_contextPath+"/networks/avatars/30x30"+b+'" /><span class="glyphicon glyphicon-question-sign"></span>'+e[g]+"</a>"}else{f+='<a class="btn btn-xs btn-material-grey" role="button" href="'+global_contextPath+"/mobileusertag/"+i[g]+'.htm"><img class="hidden tagavatar '+(h[g]==="1"?"daren":"")+'" src="'+global_contextPath+"/networks/avatars/30x30"+b+'" /><span class="glyphicon glyphicon-edit"></span>'+e[g]+"</a>"}}}break}}return f});Handlebars.registerHelper("tagList",function(d){var i=d.usertagids.split(","),e=d.tags.split(","),h=d.usertagdaren.split(","),j=d.usertagfunctionflag.split(","),f="",b=d.avatar!==""?d.avatar:"avatar.jpg",c=0;if(d.uid==global_onlineuser.uid){c=1}for(var g=0;g<e.length;g++){if(e[g]!==null&&e[g]!==""){if(j[g]!="1"){f+='<a class="btn btn-xs btn-material-grey" target="_blank" href="'+global_contextPath+"/mobileusertag/"+i[g]+'.htm"><span class="avatar"></span>'+e[g]+"</a>"}}}return f});Handlebars.registerHelper("shortenPostBody",function(b){var c=$("<div/>").append(b).text().trunc(120);return c});Handlebars.registerHelper("transformUrl",function(b){return replacelinks(b)});Handlebars.registerHelper("fetchDomainInUrl",function(b){return fetch_domain_of_url(b)});Handlebars.registerHelper("stripTags",function(c){var b=$("<div/>").append(c).text();if(b.length){b="&nbsp;-&nbsp;"+b}return b});Handlebars.registerHelper("taglistString",function(c){var b=c.tags.split(","),d="";for(a=0;a<b.length;a++){if(b[a]!==null&&b[a]!==""){if(a===b.length-1){d+=b[a]}else{d+=b[a]+" "}}}return d});Handlebars.registerHelper("functionTagFlagClass",function(d){var b=d.tags.split(","),f=d.usertagfunctionflag.split(","),e="gbshare";for(var c=0;c<b.length;c++){if(f[c]==="1"){if(b[c]==="#原创"){e="gboriginal"}else{if(b[c]==="#文章"){e="gbarticle"}else{if(b[c]==="#问答"){e="gbquestion"}else{if(b[c]==="#资源"){e="gbfreebie"}else{if(b[c]==="#调试"){e="gbdebug"}}}}}break}}return e});Handlebars.registerHelper("ifCanDelete",function(d){var f="";var b=d.tags.split(","),g=d.usertagfunctionflag.split(","),e="";for(var c=0;c<b.length;c++){if(g[c]==="1"){if(b[c]==="#原创"){e="editpost"}else{if(b[c]==="#文章"){e="editpost"}else{if(b[c]==="#链接"){e="editlink"}else{if(b[c]==="#问答"){e="editquestion"}else{if(b[c]==="#资源"){e="editfreebie"}else{if(b[c]==="#调试"){e="editgbdebug"}}}}}}break}}if(d.uid==global_onlineuser.uid){f='<a style="cursor:pointer" rel="'+d.pid+'" class="postdelete iconbefore"><span class="ui-icon ui-icon-trash"></span>删除</a>'}if(d.uid==global_onlineuser.uid||global_onlineuser.roleid<0){f=f+'<a target="_blank" href="'+global_contextPath+"/"+e+".htm?postid="+d.pid+'" class="iconbefore"><span class="ui-icon ui-icon-pencil"></span>编辑</a>'}return f});Handlebars.registerHelper("ifCanFollow",function(c){var d="",b=c.tags.split(",");if(global_onlineuser.uid!==0&&c.uid!==global_onlineuser.uid){d='<a style="cursor:pointer" rel="'+c.pid+'" class="postfollow iconbefore" title="关注用户标签"><span class="ui-icon ui-icon-tag"></span> '+b.length+" </a>"}return d});Handlebars.registerHelper("fromNow",function(d){var c=moment(d),b=moment();if(b.diff(c,"days")>=1){return c.format("YYYY年MM月D日 HH:mm:ss")}else{return c.fromNow()}});Handlebars.registerHelper("gbtagsTitle",function(b){return b.title[0]});Handlebars.registerHelper("if_even",function(c,b){if((c%2)==0){return b.fn(this)}else{return b.inverse(this)}});Handlebars.registerHelper("shortenTextBy280",function(b){return b.trunc(150)});Handlebars.registerHelper("compare",function(c,f,e){if(arguments.length<3){throw new Error("Handlerbars Helper 'compare' 需要两个参数")}operator=e.hash.operator||"==";var d={"==":function(g,h){return g==h},"===":function(g,h){return g===h},"!=":function(g,h){return g!=h},"<":function(g,h){return g<h},">":function(g,h){return g>h},"<=":function(g,h){return g<=h},">=":function(g,h){return g>=h},"typeof":function(g,h){return typeof g==h}};if(!d[operator]){throw new Error("Handlerbars Helper 'compare' 使用了不存在的比较符号 "+operator)}var b=d[operator](c,f);if(b){return e.fn(this)}else{return e.inverse(this)}})});